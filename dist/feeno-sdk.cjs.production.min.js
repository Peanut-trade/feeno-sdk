"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("axios")),r=require("ethers"),n=require("@ethereumjs/common"),i=e(n),a=require("@ethereumjs/tx"),s=require("@openzeppelin/contracts/build/contracts/ERC721.json");function o(e,t,r,n,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void r(e)}o.done?t(u):Promise.resolve(u).then(n,i)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,u,"next",e)}function u(e){o(a,n,i,s,u,"throw",e)}s(void 0)}))}}var c,p,h,f,l=(function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=Object.create((t&&t.prototype instanceof h?t:h).prototype),a=new S(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return{value:void 0,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var o=w(s,r);if(o){if(o===p)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=c(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function h(){}function f(){}function l(){}var d={};o(d,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(k([])));y&&y!==t&&r.call(y,i)&&(d=y);var x=l.prototype=h.prototype=Object.create(d);function v(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function g(e,t){var n;this._invoke=function(i,a){function s(){return new t((function(n,s){!function n(i,a,s,o){var u=c(e[i],e,a);if("throw"!==u.type){var p=u.arg,h=p.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,o)}),(function(e){n("throw",e,s,o)})):t.resolve(h).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,o)}))}o(u.arg)}(i,a,n,s)}))}return n=n?n.then(s,s):s()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,p;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:F}}function F(){return{value:void 0,done:!0}}return f.prototype=l,o(x,"constructor",l),o(l,"constructor",f),f.displayName=o(l,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,o(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},v(g.prototype),o(g.prototype,a,(function(){return this})),e.AsyncIterator=g,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var s=new g(u(t,r,n,i),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},v(x),o(x,s,"Generator"),o(x,i,(function(){return this})),o(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=k,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var o=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(o&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(f={exports:{}}),f.exports),d={1:{apiURL:"https://api-feeno.peanut.trade/v1",FeeNoContract:"0xFee1708400f01f2Bb8848Ef397C1a2F4C25c910B"},5:{apiURL:"https://devapi-feeno.peanut.trade/v1",FeeNoContract:"0xFee1708400f01f2Bb8848Ef397C1a2F4C25c910B"}},m=function(){function e(e){this.apiUrl=e}var r=e.prototype;return r.getTokens=function(){var e=u(l.mark((function e(){var r;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.apiUrl+"/tokens",e.next=3,t.get(r);case 3:return e.abrupt("return",e.sent.data.tokens);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.createFeenoRequest=function(){var e=u(l.mark((function e(r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.apiUrl+"/estimate",e.next=3,t.post(n,r);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.send=function(){var e=u(l.mark((function e(r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.apiUrl+"/submit",e.next=3,t.post(n,r);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.getStatus=function(){var e=u(l.mark((function e(r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.apiUrl+"/bundle/"+r,e.next=3,t.get(n);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.cancel=function(){var e=u(l.mark((function e(r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.apiUrl+"/bundle/"+r+"/cancel",e.next=3,t.delete(n);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}();(exports.TransactionStatus||(exports.TransactionStatus={})).InprogressType="inProgress",(c=exports.TransactionType||(exports.TransactionType={})).TransferType="transfer",c.SwapInputType="exactInput",c.SwapOutputType="exactOutput",c.SwapInputSingleType="exactInputSingle",c.SwapOutputSingleType="exactOutputSingle",c.ClaimFeeType="claimFee",c.CreatePositionType="createPosition",c.IncreaseLiquidityType="increaseLiquidity",c.DecreaseLiquidityType="decreaseLiquidity",c.CollectType="collect",c.SwapExactTokensForTokensType="swapExactTokensForTokens",c.SwapExactTokensForETHType="swapExactTokensForETH",c.SwapExactETHForTokensType="swapExactETHForTokens",(p=exports.ExType||(exports.ExType={})).DEX="dexSwap",p.CEX="cexSwap",(h=exports.SupportedChains||(exports.SupportedChains={}))[h.MAINNET=1]="MAINNET",h[h.GOERLI=5]="GOERLI";var y=function(){function e(e){if(void 0===e&&(e=1),!Object.values(exports.SupportedChains).includes(e))throw new Error("Unsupported network");this.chainId=e,this.apiURL=d[this.chainId].apiURL,this.FeeNoApi=new m(this.apiURL)}var t=e.prototype;return t.createFeenoRequest=function(){var e=u(l.mark((function e(t,r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.FeeNoApi.createFeenoRequest(t);case 2:if(n=e.sent,"Wallet"!==r.constructor.name){e.next=5;break}return e.abrupt("return",new v(n,r,this.chainId,this.FeeNoApi));case 5:return e.abrupt("return",new g(n,r,this.chainId,this.FeeNoApi));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.getTokens=function(){var e=u(l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.FeeNoApi.getTokens();case 2:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),x=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}],v=function(){function e(e,t,a,s){this.provider=t,this.estimationResponse=e,this.chainId=a,this.FeeNoApi=s,this.common=new i({chain:this.chainId,hardfork:n.Hardfork.London}),this.maxFeePerGas=r.ethers.utils.parseUnits(this.estimationResponse.marketGasPriceGwei.baseFee.toString(),"gwei")._hex,this.maxPriorityFeePerGas=r.ethers.utils.hexlify(r.ethers.BigNumber.from(0)),this.bundleId="0x"}var t=e.prototype;return t._getSwapType=function(e){return"optimalSwap"!==e.exType?e.exType:!this.estimationResponse.executionSwap.cexSwap.miningSpeed[e.speed].ethGasFee||this.estimationResponse.executionSwap.dexSwap.miningSpeed[e.speed].ethGasFee<this.estimationResponse.executionSwap.cexSwap.miningSpeed[e.speed].ethGasFee?exports.ExType.DEX:exports.ExType.CEX},t._approveTokensUse=function(){var e=u(l.mark((function e(t){var n,i=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.abi,e.abrupt("return",Promise.all(this.estimationResponse.approveRequired.map(function(){var e=u(l.mark((function e(a,s){var o,u,c,p,h,f,d;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.estimationResponse.executionSwap[t].simulations.approve[s].gasUsage,a.tokenId?(c=new r.ethers.Contract(a.tokenAddress.toString(),n,i.provider),p=a.tokenId,u=r.ethers.BigNumber.from(55e3)):(c=new r.ethers.Contract(a.tokenAddress.toString(),x,i.provider),p=a.amount,u=r.ethers.BigNumber.from(o)),e.next=4,c.populateTransaction.approve(a.spender,p);case 4:return h=e.sent,e.next=7,i.provider.getTransactionCount();case 7:return e.t0=e.sent,e.t1=s,f=e.t0+e.t1,d={type:"0x02",chainId:r.ethers.utils.hexlify(i.chainId),nonce:r.ethers.utils.hexlify(r.ethers.BigNumber.from(f),{hexPad:"left"}),maxFeePerGas:i.maxFeePerGas,maxPriorityFeePerGas:i.maxPriorityFeePerGas,gasLimit:r.ethers.utils.hexlify(u,{hexPad:"left"}),to:h.to,value:r.ethers.utils.hexlify(r.ethers.BigNumber.from(0)),data:h.data},e.abrupt("return",i._signTransfer(d));case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._approveETHTransfer=function(){var e=u(l.mark((function e(t,n,i){var a,s,o,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.provider.getAddress();case 2:return s=e.sent,o=d[this.chainId].FeeNoContract,u=(this.estimationResponse.executionSwap[t].miningSpeed[n].ethGasFee*Math.pow(10,18)).toFixed(0),a=this.estimationResponse.ETHQuantity?this.estimationResponse.erc20TokenToPayFee?r.ethers.BigNumber.from(this.estimationResponse.ETHQuantity).add(u).toString():this.estimationResponse.ETHQuantity:u,e.t0=r.ethers.utils.hexlify(this.chainId),e.t1=r.ethers.utils,e.t2=r.ethers.BigNumber,e.next=11,this.provider.getTransactionCount();case 11:return e.t3=e.sent,e.t4=i,e.t5=e.t3+e.t4,e.t6=e.t2.from.call(e.t2,e.t5),e.t7={hexPad:"left"},e.t8=e.t1.hexlify.call(e.t1,e.t6,e.t7),e.t9=this.maxFeePerGas,e.t10=this.maxPriorityFeePerGas,e.t11=r.ethers.utils.hexlify(r.ethers.BigNumber.from(21100),{hexPad:"left"}),e.t12=s,e.t13=o,e.t14=r.ethers.utils.hexlify(r.ethers.BigNumber.from(a)),e.abrupt("return",this._signTransfer({type:"0x02",chainId:e.t0,nonce:e.t8,maxFeePerGas:e.t9,maxPriorityFeePerGas:e.t10,gasLimit:e.t11,from:e.t12,to:e.t13,value:e.t14}));case 25:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t._signMessage=function(){var e=u(l.mark((function e(t){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.provider.signMessage(t);case 2:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._signTransfer=function(){var e=u(l.mark((function e(t){var n,i,s,o;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.FeeMarketEIP1559Transaction.fromTxData(t,{common:this.common}),i=n.getMessageToSign(),e.next=4,this._signMessage(i);case 4:return s=r.ethers.utils.splitSignature(e.sent),o=n._processSignature(s.v,Buffer.from(r.ethers.utils.arrayify(s.r)),Buffer.from(r.ethers.utils.arrayify(s.s))),e.abrupt("return",r.ethers.utils.hexlify(o.serialize()));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._getExecuteAllowance=function(){var e=u(l.mark((function e(t,n){var i;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.ethers.utils.arrayify(this.estimationResponse.executionSwap[t].miningSpeed[n].data.messageForSing),e.next=4,this._signMessage(i);case 4:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.send=function(){var e=u(l.mark((function e(t){var r,n,i,a;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getSwapType(t),e.next=3,this._approveTokensUse(r);case 3:if(n=e.sent,!this.estimationResponse.ETHQuantity&&this.estimationResponse.erc20TokenToPayFee){e.next=10;break}return e.t0=n,e.next=8,this._approveETHTransfer(r,t.speed,n.length);case 8:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 10:return e.next=12,this._getExecuteAllowance(r,t.speed);case 12:return i={estimationId:this.estimationResponse.id,approvalTxRawData:n,userSign:e.sent,processingMode:r,miningSpeed:t.speed,blocksCountToResubmit:20},e.next=16,this.FeeNoApi.send(i);case 16:return this.bundleId=(a=e.sent).bundleId?a.bundleId:this.bundleId,e.abrupt("return",a);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.cancel=function(){var e=u(l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.FeeNoApi.cancel(this.bundleId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getStatus=function(){var e=u(l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.FeeNoApi.getStatus(this.bundleId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),g=function(){function e(e,t,a,s){this.estimationResponse=e,this.provider=t,this.signer=t.getSigner(),this.chainId=a,this.FeeNoApi=s,this.common=new i({chain:this.chainId,hardfork:n.Hardfork.London}),this.maxFeePerGas=r.ethers.utils.parseUnits(this.estimationResponse.marketGasPriceGwei.baseFee.toString(),"gwei")._hex,this.maxPriorityFeePerGas=r.ethers.utils.hexlify(r.ethers.BigNumber.from(0)),this.bundleId="0x"}var t=e.prototype;return t._getSignature=function(){var e=u(l.mark((function e(t,r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.provider.provider.request){e.next=6;break}return e.next=3,this.provider.provider.request({method:"eth_sign",params:[t,r]});case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0="";case 7:if(n=e.t0){e.next=10;break}throw new Error("No signature data");case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t._getSwapType=function(e){return"optimalSwap"!==e.exType?e.exType:!this.estimationResponse.executionSwap.cexSwap.miningSpeed[e.speed].ethGasFee||this.estimationResponse.executionSwap.dexSwap.miningSpeed[e.speed].ethGasFee<this.estimationResponse.executionSwap.cexSwap.miningSpeed[e.speed].ethGasFee?exports.ExType.DEX:exports.ExType.CEX},t._approveTokensUse=function(){var e=u(l.mark((function e(t){var n,i,a,o=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.estimationResponse.approveRequired,e.next=3,this.signer.getAddress();case 3:return i=e.sent,a=s.abi,e.abrupt("return",Promise.all(n.map(function(){var e=u(l.mark((function e(n,s){var u,c,p,h,f,d,m;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=o.estimationResponse.executionSwap[t].simulations.approve[s].gasUsage,n.tokenId?(p=new r.ethers.Contract(n.tokenAddress.toString(),a,o.provider),h=n.tokenId,c=r.ethers.BigNumber.from(55e3)):(p=new r.ethers.Contract(n.tokenAddress.toString(),x,o.provider),h=n.amount,c=r.ethers.BigNumber.from(u)),e.next=4,p.populateTransaction.approve(n.spender,h);case 4:return f=e.sent,e.next=7,o.signer.getTransactionCount();case 7:return e.t0=e.sent,e.t1=s,d=e.t0+e.t1,m={type:"0x02",chainId:r.ethers.utils.hexlify(o.chainId),nonce:r.ethers.utils.hexlify(r.ethers.BigNumber.from(d),{hexPad:"left"}),maxFeePerGas:o.maxFeePerGas,maxPriorityFeePerGas:o.maxPriorityFeePerGas,gasLimit:r.ethers.utils.hexlify(c,{hexPad:"left"}),to:f.to,value:r.ethers.utils.hexlify(r.ethers.BigNumber.from(0)),data:f.data},e.abrupt("return",o._signTransfer(m,i));case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._approveETHTransfer=function(){var e=u(l.mark((function e(t,n,i){var a,s,o,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signer.getAddress();case 2:return s=e.sent,o=d[this.chainId].FeeNoContract,u=(this.estimationResponse.executionSwap[t].miningSpeed[n].ethGasFee*Math.pow(10,18)).toFixed(0),a=this.estimationResponse.ETHQuantity?this.estimationResponse.erc20TokenToPayFee?r.ethers.BigNumber.from(this.estimationResponse.ETHQuantity).add(u).toString():this.estimationResponse.ETHQuantity:u,e.t0=r.ethers.utils.hexlify(this.chainId),e.t1=r.ethers.utils,e.t2=r.ethers.BigNumber,e.next=11,this.signer.getTransactionCount();case 11:return e.t3=e.sent,e.t4=i,e.t5=e.t3+e.t4,e.t6=e.t2.from.call(e.t2,e.t5),e.t7={hexPad:"left"},e.t8=e.t1.hexlify.call(e.t1,e.t6,e.t7),e.t9=this.maxFeePerGas,e.t10=this.maxPriorityFeePerGas,e.t11=r.ethers.utils.hexlify(r.ethers.BigNumber.from(21100),{hexPad:"left"}),e.t12=s,e.t13=o,e.t14=r.ethers.utils.hexlify(r.ethers.BigNumber.from(a)),e.abrupt("return",this._signTransfer({type:"0x02",chainId:e.t0,nonce:e.t8,maxFeePerGas:e.t9,maxPriorityFeePerGas:e.t10,gasLimit:e.t11,from:e.t12,to:e.t13,value:e.t14},s));case 25:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t._signTransfer=function(){var e=u(l.mark((function e(t,n){var i,s,o,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.FeeMarketEIP1559Transaction.fromTxData(t,{common:this.common}),s=i.getMessageToSign(),e.next=4,this._getSignature(n,r.ethers.utils.hexlify(s));case 4:return o=r.ethers.utils.splitSignature(e.sent),u=i._processSignature(o.v,Buffer.from(r.ethers.utils.arrayify(o.r)),Buffer.from(r.ethers.utils.arrayify(o.s))),e.abrupt("return",r.ethers.utils.hexlify(u.serialize()));case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t._getExecuteAllowance=function(){var e=u(l.mark((function e(t,n){var i,a,s;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signer.getAddress();case 2:return i=e.sent,a=r.ethers.utils.arrayify(this.estimationResponse.executionSwap[t].miningSpeed[n].data.messageForSing),s=r.ethers.utils.keccak256(r.ethers.utils.concat([r.ethers.utils.toUtf8Bytes("Ethereum Signed Message:\n"),r.ethers.utils.toUtf8Bytes(String(a.length)),a])),e.next=8,this._getSignature(i,s);case 8:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.send=function(){var e=u(l.mark((function e(t){var r,n,i,a;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getSwapType(t),e.next=3,this._approveTokensUse(r);case 3:if(n=e.sent,!this.estimationResponse.ETHQuantity&&this.estimationResponse.erc20TokenToPayFee){e.next=10;break}return e.t0=n,e.next=8,this._approveETHTransfer(r,t.speed,n.length);case 8:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 10:return e.next=12,this._getExecuteAllowance(r,t.speed);case 12:return i={estimationId:this.estimationResponse.id,approvalTxRawData:n,userSign:e.sent,processingMode:r,miningSpeed:t.speed,blocksCountToResubmit:20},e.next=16,this.FeeNoApi.send(i);case 16:return this.bundleId=(a=e.sent).bundleId?a.bundleId:this.bundleId,e.abrupt("return",a);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.cancel=function(){var e=u(l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.FeeNoApi.cancel(this.bundleId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getStatus=function(){var e=u(l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.FeeNoApi.getStatus(this.bundleId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}();exports.FeeNo=y,exports.WalletFeeNoRequest=v,exports.Web3ProviderFeeNoRequest=g;
//# sourceMappingURL=feeno-sdk.cjs.production.min.js.map
